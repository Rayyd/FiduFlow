---
import MetaTags from "../components/MetaTags.astro";
import Nav from "../components/Nav.astro";
import Footer from "../components/Footer.astro";
import CookieBanner from "../components/CookieBanner.astro";
import AnalyticsPlausible from "../components/AnalyticsPlausible.astro";

interface Props { title?: string; description?: string; canonical?: string; }
const { title, description, canonical } = Astro.props;

// Normalise BASE_URL => toujours un "/" final
const BASE = import.meta.env.BASE_URL?.endsWith("/")
  ? import.meta.env.BASE_URL
  : (import.meta.env.BASE_URL || "/") + "/";
---
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <MetaTags {title} {description} {canonical} />

    <link rel="manifest" href={`${BASE}manifest.webmanifest`} />
    <link rel="icon" href={`${BASE}favicon.svg`} />
    <link rel="preload" as="image" href={`${BASE}og-image.png`} />

    <!-- CSS via Astro.resolve pour éviter les chemins cassés -->
    <link rel="stylesheet" href={Astro.resolve("../styles/global.css")} />
  </head>
  <body class="bg-white">
    <a href="#main" class="skip-link">Skip to content</a>
    <Nav />
    <main id="main" class="min-h-[60vh]">
      <slot />
    </main>
    <Footer />
    <CookieBanner />
    <AnalyticsPlausible />
  </body>
</html>
